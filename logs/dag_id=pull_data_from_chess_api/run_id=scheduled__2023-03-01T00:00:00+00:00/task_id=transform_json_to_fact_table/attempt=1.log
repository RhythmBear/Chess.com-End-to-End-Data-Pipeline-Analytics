[2025-02-18T16:08:23.817+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-18T16:08:23.837+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-02-18T16:08:23.846+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-02-18T16:08:23.847+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-02-18T16:08:23.866+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2023-03-01 00:00:00+00:00
[2025-02-18T16:08:23.878+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=2826) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-02-18T16:08:23.881+0000] {standard_task_runner.py:72} INFO - Started process 2827 to run task
[2025-02-18T16:08:23.882+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2023-03-01T00:00:00+00:00', '--job-id', '140', '--raw', '--subdir', 'DAGS_FOLDER/chess_dag.py', '--cfg-path', '/tmp/tmpvegvwfc8']
[2025-02-18T16:08:23.884+0000] {standard_task_runner.py:105} INFO - Job 140: Subtask transform_json_to_fact_table
[2025-02-18T16:08:23.981+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [running]> on host 4ed02a11bf8e
[2025-02-18T16:08:24.198+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2023-03-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-03-01T00:00:00+00:00'
[2025-02-18T16:08:24.200+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-18T16:08:24.223+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-02-18T16:08:24.237+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-02-18T16:08:25.291+0000] {logging_mixin.py:190} INFO - /tmp/tmp5g0lbt73
[2025-02-18T16:08:25.299+0000] {taskinstance.py:3310} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/scripts/python_scripts.py", line 109, in transform_json_to_fact_table
    fact_table = duckdb.sql("""
                 ^^^^^^^^^^^^^^
duckdb.duckdb.BinderException: Binder Error: Referenced column "url" not found in FROM clause!
Candidate bindings: "json"
[2025-02-18T16:08:25.334+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2023-03-01T00:00:00+00:00, execution_date=20230301T000000, start_date=20250218T160823, end_date=20250218T160825
[2025-02-18T16:08:25.399+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-18T16:08:25.400+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 140 for task transform_json_to_fact_table (Binder Error: Referenced column "url" not found in FROM clause!
Candidate bindings: "json"; 2827)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 115, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3004, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3158, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3182, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/scripts/python_scripts.py", line 109, in transform_json_to_fact_table
    fact_table = duckdb.sql("""
                 ^^^^^^^^^^^^^^
duckdb.duckdb.BinderException: Binder Error: Referenced column "url" not found in FROM clause!
Candidate bindings: "json"
[2025-02-18T16:08:25.469+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-02-18T16:08:25.496+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-02-18T16:38:16.345+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-18T16:38:16.407+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-02-18T16:38:16.439+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-02-18T16:38:16.440+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-02-18T16:38:16.491+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2023-03-01 00:00:00+00:00
[2025-02-18T16:38:16.518+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3588) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-02-18T16:38:16.522+0000] {standard_task_runner.py:72} INFO - Started process 3589 to run task
[2025-02-18T16:38:16.524+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2023-03-01T00:00:00+00:00', '--job-id', '193', '--raw', '--subdir', 'DAGS_FOLDER/chess_dag.py', '--cfg-path', '/tmp/tmpb5cqzikb']
[2025-02-18T16:38:16.528+0000] {standard_task_runner.py:105} INFO - Job 193: Subtask transform_json_to_fact_table
[2025-02-18T16:38:16.698+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [running]> on host 4ed02a11bf8e
[2025-02-18T16:38:17.037+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2023-03-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-03-01T00:00:00+00:00'
[2025-02-18T16:38:17.041+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-18T16:38:17.103+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-02-18T16:38:17.133+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-02-18T16:38:18.472+0000] {logging_mixin.py:190} INFO - /tmp/tmp98he482q
[2025-02-18T16:38:21.270+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2023-03-games.csv
[2025-02-18T16:38:21.272+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-02-18T16:38:21.330+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-18T16:38:21.332+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2023-03-01T00:00:00+00:00, execution_date=20230301T000000, start_date=20250218T163816, end_date=20250218T163821
[2025-02-18T16:38:21.468+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-02-18T16:38:21.530+0000] {standard_task_runner.py:217} INFO - Process not found (most likely exited), stop collecting metrics
[2025-02-18T16:38:21.538+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-18T16:38:21.543+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-03-10T01:33:26.158+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-10T01:33:26.174+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-03-10T01:33:26.181+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [queued]>
[2025-03-10T01:33:26.181+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-03-10T01:33:26.194+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2023-03-01 00:00:00+00:00
[2025-03-10T01:33:26.200+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=16548) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-03-10T01:33:26.202+0000] {standard_task_runner.py:72} INFO - Started process 16550 to run task
[2025-03-10T01:33:26.202+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2023-03-01T00:00:00+00:00', '--job-id', '494', '--raw', '--subdir', 'DAGS_FOLDER/collect_chess_data_dag.py', '--cfg-path', '/tmp/tmpiga0o0yl']
[2025-03-10T01:33:26.205+0000] {standard_task_runner.py:105} INFO - Job 494: Subtask transform_json_to_fact_table
[2025-03-10T01:33:26.248+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2023-03-01T00:00:00+00:00 [running]> on host 70b3b9cfbba0
[2025-03-10T01:33:26.327+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2023-03-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2023-03-01T00:00:00+00:00'
[2025-03-10T01:33:26.328+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-10T01:33:26.344+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-03-10T01:33:26.355+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-03-10T01:33:27.314+0000] {logging_mixin.py:190} INFO - /tmp/tmpuqn3bazv
[2025-03-10T01:33:27.326+0000] {logging_mixin.py:190} INFO - Previewing Dataframe
[2025-03-10T01:33:27.328+0000] {logging_mixin.py:190} INFO - game_url                        object
time_control                    object
rated                             bool
time_class                      object
rules                           object
white_rating                     int64
white_result                    object
black_rating                     int64
black_result                    object
pgn_event                       object
pgn_site                        object
game_date               datetime64[us]
pgn_white_user                  object
pgn_black_user                  object
pgn_result                      object
pgn_current_position            object
pgn_timezone                    object
pgn_eco                         object
pgn_eco_url                     object
start_time                      object
end_time                        object
end_game_date           datetime64[us]
pgn_raw                         object
pgn_trans                       object
dtype: object
[2025-03-10T01:33:27.341+0000] {logging_mixin.py:190} INFO - https://www.chess.com/game/live/71599316007	600	True	rapid	chess	1027	win	902	resigned	Live Chess	Chess.com	2023-03-03 00:00:00	SonXAzzz	Rhythmbear1	1-0	4r1k1/1bp1P2p/p5p1/2N2p2/1q3P2/P6P/1P2Q1P1/R1B1R1K1 w - -	UTC	C46	https://www.chess.com/openings/Three-Knights-Opening-3...d6	16:15:37	16:27:13	2023-03-03 00:00:00	e4 e5 Nf3 Nc6 Nc3 d6 Bb5 a6 Bxc6+ bxc6 O-O Nf6 h3 Bb7 d3 d5 a3 Bd6 Re1 O-O d4 Re8 dxe5 Bxe5 Nxe5 Rxe5 f4 Rh5 e5 Ng4 Qxg4 f5 Qxh5 d4 Ne2 d3 cxd3 Qxd3 Nc3 g6 Qe2 Qg3 e6 c5 e7 Re8 Na4 Qb3 Nxc5 Qb4	1. e4 e5 2. Nf3 Nc6 3. Nc3 d6 4. Bb5 a6 5. Bxc6+ bxc6 6. O-O Nf6 7. h3 Bb7 8. d3 d5 9. a3 Bd6 10. Re1 O-O 11. d4 Re8 12. dxe5 Bxe5 13. Nxe5 Rxe5 14. f4 Rh5 15. e5 Ng4 16. Qxg4 f5 17. Qxh5 d4 18. Ne2 d3 19. cxd3 Qxd3 20. Nc3 g6 21. Qe2 Qg3 22. e6 c5 23. e7 Re8 24. Na4 Qb3 25. Nxc5 Qb4
https://www.chess.com/game/live/72088506679	600	True	rapid	chess	940	win	893	checkmated	Live Chess	Chess.com	2023-03-09 00:00:00	Rhythmbear1	Orsolya_111	1-0	r4k1Q/p1pp4/bp1n2p1/5pN1/2Pn4/3B4/P1P2PPP/2K1R3 b - -	UTC	C42	https://www.chess.com/openings/Petrovs-Defense-Three-Knights-Game	08:13:56	08:22:59	2023-03-09 00:00:00	e4 Nf6 Nc3 e5 Nf3 Bd6 d4 exd4 Qxd4 h6 e5 Qe7 Bf4 Nc6 Qd3 Bxe5 Be3 Bxc3+ bxc3 O-O O-O-O g6 c4 b6 Be2 Ba6 Rhe1 Rfd8 Bd4 Qa3+ Qxa3 Ne4 Qe3 Nd6 Bd3 Re8 Qxh6 Rxe1 Rxe1 f5 Ng5 Nxd4 Qh7+ Kf8 Qh8#	1. e4 Nf6 2. Nc3 e5 3. Nf3 Bd6 4. d4 exd4 5. Qxd4 h6 6. e5 Qe7 7. Bf4 Nc6 8. Qd3 Bxe5 9. Be3 Bxc3+ 10. bxc3 O-O 11. O-O-O g6 12. c4 b6 13. Be2 Ba6 14. Rhe1 Rfd8 15. Bd4 Qa3+ 16. Qxa3 Ne4 17. Qe3 Nd6 18. Bd3 Re8 19. Qxh6 Rxe1 20. Rxe1 f5 21. Ng5 Nxd4 22. Qh7+ Kf8 23. Qh8# 
https://www.chess.com/game/live/72622856493	900+10	True	rapid	chess	1036	checkmated	986	win	Live Chess	Chess.com	2023-03-15 00:00:00	tomdesmedt	Rhythmbear1	0-1	5k2/7p/8/p4P2/Pp4PP/1P6/6rr/5RK1 w - -	UTC	D02	https://www.chess.com/openings/Queens-Pawn-Opening-Zukertort-Chigorin-Variation-3.g3	12:34:27	13:13:24	2023-03-15 00:00:00	Nf3 d5 g3 Nc6 d4 e5 Nxe5 Nxe5 dxe5 Bf5 Nc3 c6 Bg2 Ne7 Bg5 f6 exf6 gxf6 Bxf6 Rg8 e4 Bg7 Bxg7 Rxg7 exf5 Nxf5 Qh5+ Rf7 O-O Qd6 Rfe1+ Kf8 Bh3 Nd4 Red1 Qf6 f4 Nxc2 Rac1 Ne3 Re1 Qd4 Kh1 Qd2 Qe2 Nc4 Qxd2 Nxd2 Re2 Nc4 b3 Nd6 Rce1 a5 a4 b5 Re6 b4 Nxd5 Nf5 Rxc6 Nd4 Rb1 Nxc6 Bg2 Rd8 Nb6 Nd4 Bd5 Rf6 Rd1 Rxb6 Rxd4 Rbd6 f5 Rxd5 Rf4 Rd2 g4 Re8 Rf1 Ree2 h4 Rh2+ Kg1 Rdg2#	1. Nf3 d5 2. g3 Nc6 3. d4 e5 4. Nxe5 Nxe5 5. dxe5 Bf5 6. Nc3 c6 7. Bg2 Ne7 8. Bg5 f6 9. exf6 gxf6 10. Bxf6 Rg8 11. e4 Bg7 12. Bxg7 Rxg7 13. exf5 Nxf5 14. Qh5+ Rf7 15. O-O Qd6 16. Rfe1+ Kf8 17. Bh3 Nd4 18. Red1 Qf6 19. f4 Nxc2 20. Rac1 Ne3 21. Re1 Qd4 22. Kh1 Qd2 23. Qe2 Nc4 24. Qxd2 Nxd2 25. Re2 Nc4 26. b3 Nd6 27. Rce1 a5 28. a4 b5 29. Re6 b4 30. Nxd5 Nf5 31. Rxc6 Nd4 32. Rb1 Nxc6 33. Bg2 Rd8 34. Nb6 Nd4 35. Bd5 Rf6 36. Rd1 Rxb6 37. Rxd4 Rbd6 38. f5 Rxd5 39. Rf4 Rd2 40. g4 Re8 41. Rf1 Ree2 42. h4 Rh2+ 43. Kg1 Rdg2#
https://www.chess.com/game/live/72625984471	900+10	True	rapid	chess	982	abandoned	1019	win	Live Chess	Chess.com	2023-03-15 00:00:00	Saigon-1996	Rhythmbear1	0-1	rn3rk1/5pp1/1qpb1p1p/3p4/3P1N2/1P1bPPQ1/1P2N1BP/2K4R w - -	UTC	A00	https://www.chess.com/openings/Grob-Opening-Grob-Gambit-Declined	13:28:10	13:49:28	2023-03-15 00:00:00	g4 d5 Bg2 c6 d4 Bxg4 f3 Bh5 Nc3 Nf6 Bg5 h6 Bxf6 exf6 Qd3 Bg6 Qe3+ Be7 O-O-O a5 Nh3 O-O Nf4 Bh7 Qf2 a4 Nh5 b5 Qg3 Bg6 Nf4 Bd6 e3 b4 Nce2 b3 axb3 axb3 cxb3 Qb6 Rd3 Bxd3	1. g4 d5 2. Bg2 c6 3. d4 Bxg4 4. f3 Bh5 5. Nc3 Nf6 6. Bg5 h6 7. Bxf6 exf6 8. Qd3 Bg6 9. Qe3+ Be7 10. O-O-O a5 11. Nh3 O-O 12. Nf4 Bh7 13. Qf2 a4 14. Nh5 b5 15. Qg3 Bg6 16. Nf4 Bd6 17. e3 b4 18. Nce2 b3 19. axb3 axb3 20. cxb3 Qb6 21. Rd3 Bxd3
https://www.chess.com/game/live/72774715521	900+10	True	rapid	chess	1052	win	1050	checkmated	Live Chess	Chess.com	2023-03-17 00:00:00	Rhythmbear1	markisus	1-0	3Q1k2/p4pp1/7p/3b4/1P6/8/P4PPP/3q1BK1 b - -	UTC	C55	https://www.chess.com/openings/Italian-Game-Anti-Fried-Liver-Defense	06:48:43	07:25:56	2023-03-17 00:00:00	e4 e5 Nf3 Nc6 Bc4 h6 O-O Nf6 d4 exd4 Nxd4 Nxd4 Qxd4 b6 Nc3 Bc5 Qd3 O-O Be3 Bb7 Bxc5 bxc5 Rad1 Re8 Rfe1 Nh5 Qf3 d5 exd5 Rxe1+ Rxe1 Qg5 Ne4 Qg6 Nxc5 Qxc2 Bd3 Qxc5 Qxh5 Kf8 Qf5 Re8 Rxe8+ Kxe8 Qe5+ Kf8 b4 Qc1+ Bf1 Qd1 Qxc7 Bxd5 Qd8#	1. e4 e5 2. Nf3 Nc6 3. Bc4 h6 4. O-O Nf6 5. d4 exd4 6. Nxd4 Nxd4 7. Qxd4 b6 8. Nc3 Bc5 9. Qd3 O-O 10. Be3 Bb7 11. Bxc5 bxc5 12. Rad1 Re8 13. Rfe1 Nh5 14. Qf3 d5 15. exd5 Rxe1+ 16. Rxe1 Qg5 17. Ne4 Qg6 18. Nxc5 Qxc2 19. Bd3 Qxc5 20. Qxh5 Kf8 21. Qf5 Re8 22. Rxe8+ Kxe8 23. Qe5+ Kf8 24. b4 Qc1+ 25. Bf1 Qd1 26. Qxc7 Bxd5 27. Qd8# 
[2025-03-10T01:33:27.735+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2023-03-games.parquet
[2025-03-10T01:33:27.735+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-03-10T01:33:27.747+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-10T01:33:27.748+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2023-03-01T00:00:00+00:00, execution_date=20230301T000000, start_date=20250310T013326, end_date=20250310T013327
[2025-03-10T01:33:27.789+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-10T01:33:27.818+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-03-10T01:33:27.820+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
