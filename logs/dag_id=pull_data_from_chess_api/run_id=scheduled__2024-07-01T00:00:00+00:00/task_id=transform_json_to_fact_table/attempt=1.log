[2025-02-18T16:43:56.640+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-18T16:43:56.670+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2025-02-18T16:43:56.687+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2025-02-18T16:43:56.687+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-02-18T16:43:56.717+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-07-01 00:00:00+00:00
[2025-02-18T16:43:56.730+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3898) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-02-18T16:43:56.735+0000] {standard_task_runner.py:72} INFO - Started process 3899 to run task
[2025-02-18T16:43:56.736+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '228', '--raw', '--subdir', 'DAGS_FOLDER/chess_dag.py', '--cfg-path', '/tmp/tmp9bdfmkms']
[2025-02-18T16:43:56.738+0000] {standard_task_runner.py:105} INFO - Job 228: Subtask transform_json_to_fact_table
[2025-02-18T16:43:56.842+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [running]> on host 4ed02a11bf8e
[2025-02-18T16:43:57.085+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2025-02-18T16:43:57.088+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-18T16:43:57.164+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-02-18T16:43:57.211+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-02-18T16:43:59.581+0000] {logging_mixin.py:190} INFO - /tmp/tmphj9etznq
[2025-02-18T16:44:01.731+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-07-games.csv
[2025-02-18T16:44:01.732+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-02-18T16:44:01.751+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-18T16:44:01.752+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-07-01T00:00:00+00:00, execution_date=20240701T000000, start_date=20250218T164356, end_date=20250218T164401
[2025-02-18T16:44:01.801+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-02-18T16:44:01.830+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-18T16:44:01.835+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-03-10T01:38:54.145+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-10T01:38:54.167+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2025-03-10T01:38:54.178+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [queued]>
[2025-03-10T01:38:54.178+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-03-10T01:38:54.194+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-07-01 00:00:00+00:00
[2025-03-10T01:38:54.201+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=17387) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-03-10T01:38:54.203+0000] {standard_task_runner.py:72} INFO - Started process 17389 to run task
[2025-03-10T01:38:54.204+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-07-01T00:00:00+00:00', '--job-id', '542', '--raw', '--subdir', 'DAGS_FOLDER/collect_chess_data_dag.py', '--cfg-path', '/tmp/tmpqlbm2ghw']
[2025-03-10T01:38:54.207+0000] {standard_task_runner.py:105} INFO - Job 542: Subtask transform_json_to_fact_table
[2025-03-10T01:38:54.256+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-07-01T00:00:00+00:00 [running]> on host 70b3b9cfbba0
[2025-03-10T01:38:54.356+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-07-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-07-01T00:00:00+00:00'
[2025-03-10T01:38:54.358+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-10T01:38:54.377+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-03-10T01:38:54.390+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-03-10T01:38:56.209+0000] {logging_mixin.py:190} INFO - /tmp/tmphl9l4vlj
[2025-03-10T01:38:56.264+0000] {logging_mixin.py:190} INFO - Previewing Dataframe
[2025-03-10T01:38:56.267+0000] {logging_mixin.py:190} INFO - game_url                        object
time_control                    object
rated                             bool
time_class                      object
rules                           object
white_rating                     int64
white_result                    object
black_rating                     int64
black_result                    object
pgn_event                       object
pgn_site                        object
game_date               datetime64[us]
pgn_white_user                  object
pgn_black_user                  object
pgn_result                      object
pgn_current_position            object
pgn_timezone                    object
pgn_eco                         object
pgn_eco_url                     object
start_time                      object
end_time                        object
end_game_date           datetime64[us]
pgn_raw                         object
pgn_trans                       object
dtype: object
[2025-03-10T01:38:56.286+0000] {logging_mixin.py:190} INFO - https://www.chess.com/game/live/113574006055	120+1	False	bullet	chess	557	win	795	checkmated	Live Chess	Chess.com	2024-07-01 00:00:00	Atobs	Rhythmbear1	1-0	r1bq3r/pp1n3k/2p1p1QB/3pP3/3P2P1/2PB4/P1P2P1P/R4RK1 b - -	UTC	B06	https://www.chess.com/openings/Modern-Defense-with-1-e4-2.d4-Bg7-3.Nf3	11:57:43	12:00:49	2024-07-01 00:00:00	e4 g6 d4 Bg7 Nf3 Nf6 e5 Nd5 Bc4 c6 O-O O-O Ng5 d6 Qf3 e6 Nc3 Nxc3 bxc3 d5 Bd3 Nd7 Qh3 h5 g4 Bh6 Nxe6 fxe6 Bxh6 Kh7 Qxh5 Rh8 Qxg6#	1. e4 g6 2. d4 Bg7 3. Nf3 Nf6 4. e5 Nd5 5. Bc4 c6 6. O-O O-O 7. Ng5 d6 8. Qf3 e6 9. Nc3 Nxc3 10. bxc3 d5 11. Bd3 Nd7 12. Qh3 h5 13. g4 Bh6 14. Nxe6 fxe6 15. Bxh6 Kh7 16. Qxh5 Rh8 17. Qxg6# 
https://www.chess.com/game/live/113574041127	120+1	False	bullet	chess	795	win	557	timeout	Live Chess	Chess.com	2024-07-01 00:00:00	Rhythmbear1	Atobs	1-0	r1b2rk1/ppb2pp1/2nqp1np/3p4/3P4/P1PB1NN1/1P1B1PPP/R2QR1K1 b - -	UTC	B15	https://www.chess.com/openings/Caro-Kann-Defense-2.d4-d5-3.Nc3	12:00:55	12:05:08	2024-07-01 00:00:00	e4 c6 d4 d5 Nc3 e6 Nf3 h6 Be2 Bb4 exd5 cxd5 Bd2 Ne7 O-O O-O a3 Bd6 Bd3 Nbc6 Re1 Ng6 Ne2 Bc7 c3 Qd6 Ng3	1. e4 c6 2. d4 d5 3. Nc3 e6 4. Nf3 h6 5. Be2 Bb4 6. exd5 cxd5 7. Bd2 Ne7 8. O-O O-O 9. a3 Bd6 10. Bd3 Nbc6 11. Re1 Ng6 12. Ne2 Bc7 13. c3 Qd6 14. Ng3 
https://www.chess.com/game/live/113574583629	120+1	False	bullet	chess	557	win	795	timeout	Live Chess	Chess.com	2024-07-01 00:00:00	Atobs	Rhythmbear1	1-0	2Q5/pp2rkpp/3q1p2/2pp4/4P3/P1NP3P/1PP3P1/5RK1 b - -	UTC	C00	https://www.chess.com/openings/French-Defense-Knight-Variation-2...d5-3.exd5-exd5	12:05:42	12:10:50	2024-07-01 00:00:00	e4 e6 Nf3 d5 exd5 exd5 Nc3 c6 Bd3 Bd6 O-O Ne7 Re1 O-O h3 Bf5 Rxe7 Qxe7 Bxf5 Nd7 Bxd7 Qxd7 d3 Rfe8 Be3 Re6 a3 Rae8 Nd4 R6e7 Qf3 Bc5 Nf5 Bxe3 Nxe7+ Rxe7 fxe3 Qd6 Rf1 c5 Qg4 f6 Qc8+ Kf7 e4	1. e4 e6 2. Nf3 d5 3. exd5 exd5 4. Nc3 c6 5. Bd3 Bd6 6. O-O Ne7 7. Re1 O-O 8. h3 Bf5 9. Rxe7 Qxe7 10. Bxf5 Nd7 11. Bxd7 Qxd7 12. d3 Rfe8 13. Be3 Re6 14. a3 Rae8 15. Nd4 R6e7 16. Qf3 Bc5 17. Nf5 Bxe3 18. Nxe7+ Rxe7 19. fxe3 Qd6 20. Rf1 c5 21. Qg4 f6 22. Qc8+ Kf7 23. e4 
https://www.chess.com/game/live/113574645025	120+1	False	bullet	chess	795	win	557	timeout	Live Chess	Chess.com	2024-07-01 00:00:00	Rhythmbear1	Atobs	1-0	r1b1k2r/8/p1n1p1pp/1Nb5/Q1BqPB2/8/PP4PP/R6K b - -	UTC	B12	https://www.chess.com/openings/Caro-Kann-Defense-2.d4-d5-3.Nf3	12:11:15	12:16:01	2024-07-01 00:00:00	e4 c6 d4 d5 Nf3 e6 Be2 dxe4 Ng5 Nf6 O-O h6 Nxf7 Kxf7 Bc4 c5 c3 Nc6 f3 cxd4 fxe4 Ke8 Rxf6 Qxf6 Qh5+ g6 Qb5 dxc3 Nxc3 Qd4+ Kh1 Bc5 Bf4 a6 Qa4 b5 Nxb5	1. e4 c6 2. d4 d5 3. Nf3 e6 4. Be2 dxe4 5. Ng5 Nf6 6. O-O h6 7. Nxf7 Kxf7 8. Bc4 c5 9. c3 Nc6 10. f3 cxd4 11. fxe4 Ke8 12. Rxf6 Qxf6 13. Qh5+ g6 14. Qb5 dxc3 15. Nxc3 Qd4+ 16. Kh1 Bc5 17. Bf4 a6 18. Qa4 b5 19. Nxb5 
https://www.chess.com/game/live/113575189459	120+1	False	bullet	chess	557	win	795	timeout	Live Chess	Chess.com	2024-07-01 00:00:00	Atobs	Rhythmbear1	1-0	6k1/pp6/1q3pQp/8/1b1pP3/3P2P1/2r3BK/5R2 b - -	UTC	C00	https://www.chess.com/openings/French-Defense-Queens-Knight-Variation-2...d5-3.g3	12:16:10	12:21:15	2024-07-01 00:00:00	e4 e6 Nc3 d5 g3 d4 Nce2 c5 d3 Nc6 Bg2 e5 c3 Nf6 h3 Be6 Bd2 Qb6 b3 Be7 f4 Nd7 fxe5 Ndxe5 cxd4 Nxd4 Nxd4 cxd4 Bf4 Nc6 Ne2 O-O O-O Nb4 Kh2 Rac8 Rc1 Nxa2 Rxc8 Rxc8 Be5 Bxb3 Qb1 Nc3 Qb2 Nxe2 Qxe2 Bb4 Qg4 f6 Bf4 Bf7 Bh6 Bg6 h4 gxh6 h5 Rc2 hxg6 hxg6 Qxg6+	1. e4 e6 2. Nc3 d5 3. g3 d4 4. Nce2 c5 5. d3 Nc6 6. Bg2 e5 7. c3 Nf6 8. h3 Be6 9. Bd2 Qb6 10. b3 Be7 11. f4 Nd7 12. fxe5 Ndxe5 13. cxd4 Nxd4 14. Nxd4 cxd4 15. Bf4 Nc6 16. Ne2 O-O 17. O-O Nb4 18. Kh2 Rac8 19. Rc1 Nxa2 20. Rxc8 Rxc8 21. Be5 Bxb3 22. Qb1 Nc3 23. Qb2 Nxe2 24. Qxe2 Bb4 25. Qg4 f6 26. Bf4 Bf7 27. Bh6 Bg6 28. h4 gxh6 29. h5 Rc2 30. hxg6 hxg6 31. Qxg6+ 
[2025-03-10T01:38:56.865+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-07-games.parquet
[2025-03-10T01:38:56.865+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-03-10T01:38:56.877+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-10T01:38:56.878+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-07-01T00:00:00+00:00, execution_date=20240701T000000, start_date=20250310T013854, end_date=20250310T013856
[2025-03-10T01:38:56.910+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-10T01:38:56.945+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-03-10T01:38:56.948+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
