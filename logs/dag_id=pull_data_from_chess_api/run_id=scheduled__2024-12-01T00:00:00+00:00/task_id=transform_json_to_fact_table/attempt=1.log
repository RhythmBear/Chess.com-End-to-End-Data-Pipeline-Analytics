[2025-02-18T16:45:58.514+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-18T16:45:58.554+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [queued]>
[2025-02-18T16:45:58.580+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [queued]>
[2025-02-18T16:45:58.581+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-02-18T16:45:58.619+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-12-01 00:00:00+00:00
[2025-02-18T16:45:58.641+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3990) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-02-18T16:45:58.649+0000] {standard_task_runner.py:72} INFO - Started process 3991 to run task
[2025-02-18T16:45:58.650+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-12-01T00:00:00+00:00', '--job-id', '238', '--raw', '--subdir', 'DAGS_FOLDER/chess_dag.py', '--cfg-path', '/tmp/tmpghpa5au8']
[2025-02-18T16:45:58.653+0000] {standard_task_runner.py:105} INFO - Job 238: Subtask transform_json_to_fact_table
[2025-02-18T16:45:58.779+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [running]> on host 4ed02a11bf8e
[2025-02-18T16:45:59.056+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-12-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-01T00:00:00+00:00'
[2025-02-18T16:45:59.059+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-18T16:45:59.102+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-02-18T16:45:59.151+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-02-18T16:46:06.488+0000] {logging_mixin.py:190} INFO - /tmp/tmpt1smw4s2
[2025-02-18T16:46:09.461+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-12-games.csv
[2025-02-18T16:46:09.464+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-02-18T16:46:09.503+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-18T16:46:09.505+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-12-01T00:00:00+00:00, execution_date=20241201T000000, start_date=20250218T164558, end_date=20250218T164609
[2025-02-18T16:46:09.585+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-02-18T16:46:09.616+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-18T16:46:09.622+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-03-10T01:40:41.643+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-10T01:40:41.661+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [queued]>
[2025-03-10T01:40:41.669+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [queued]>
[2025-03-10T01:40:41.670+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-03-10T01:40:41.683+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-12-01 00:00:00+00:00
[2025-03-10T01:40:41.689+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=17690) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-03-10T01:40:41.691+0000] {standard_task_runner.py:72} INFO - Started process 17692 to run task
[2025-03-10T01:40:41.692+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-12-01T00:00:00+00:00', '--job-id', '557', '--raw', '--subdir', 'DAGS_FOLDER/collect_chess_data_dag.py', '--cfg-path', '/tmp/tmp643x03cs']
[2025-03-10T01:40:41.696+0000] {standard_task_runner.py:105} INFO - Job 557: Subtask transform_json_to_fact_table
[2025-03-10T01:40:41.765+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-12-01T00:00:00+00:00 [running]> on host 70b3b9cfbba0
[2025-03-10T01:40:41.873+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-12-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-12-01T00:00:00+00:00'
[2025-03-10T01:40:41.874+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-10T01:40:41.891+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-03-10T01:40:41.902+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-03-10T01:40:44.691+0000] {logging_mixin.py:190} INFO - /tmp/tmpgmch6b3o
[2025-03-10T01:40:44.795+0000] {logging_mixin.py:190} INFO - Previewing Dataframe
[2025-03-10T01:40:44.797+0000] {logging_mixin.py:190} INFO - game_url                        object
time_control                    object
rated                             bool
time_class                      object
rules                           object
white_rating                     int64
white_result                    object
black_rating                     int64
black_result                    object
pgn_event                       object
pgn_site                        object
game_date               datetime64[us]
pgn_white_user                  object
pgn_black_user                  object
pgn_result                      object
pgn_current_position            object
pgn_timezone                    object
pgn_eco                         object
pgn_eco_url                     object
start_time                      object
end_time                        object
end_game_date           datetime64[us]
pgn_raw                         object
pgn_trans                       object
dtype: object
[2025-03-10T01:40:44.815+0000] {logging_mixin.py:190} INFO - https://www.chess.com/game/live/126794400005	120+1	True	bullet	chess	989	timeout	985	win	Live Chess	Chess.com	2024-12-01 00:00:00	Rhythmbear1	Flovassi97	0-1	8/p7/2Q5/k1P5/3PbP2/8/P4R1P/4q1K1 w - -	UTC	B18	https://www.chess.com/openings/Caro-Kann-Defense-Classical-Variation	12:18:43	12:24:19	2024-12-01 00:00:00	e4 c6 d4 d5 Nd2 dxe4 Nxe4 Bf5 Ng5 Bg6 N1f3 Nd7 Bc4 e6 O-O Ngf6 Re1 Be7 Nh4 Bh5 f3 Qc7 Nxe6 fxe6 Bxe6 O-O-O Nf5 Rde8 g3 Nd5 c4 Nb6 Bf4 Bd6 Nxd6+ Kd8 Nxe8 Qc8 Nd6 Qc7 c5 Nd5 Bxd7 Qxd7 Nxb7+ Qxb7 Qe2 Nxf4 gxf4 Re8 Qc4 Rxe1+ Rxe1 Qxb2 Rf1 Qa3 Qg8+ Kc7 Qxg7+ Kb8 Qxh7 Bxf3 Qg8+ Kb7 Qf7+ Ka6 Qe8 Be4 Qc8+ Ka5 Qxc6 Qe3+ Rf2 Qe1+	1. e4 c6 2. d4 d5 3. Nd2 dxe4 4. Nxe4 Bf5 5. Ng5 Bg6 6. N1f3 Nd7 7. Bc4 e6 8. O-O Ngf6 9. Re1 Be7 10. Nh4 Bh5 11. f3 Qc7 12. Nxe6 fxe6 13. Bxe6 O-O-O 14. Nf5 Rde8 15. g3 Nd5 16. c4 Nb6 17. Bf4 Bd6 18. Nxd6+ Kd8 19. Nxe8 Qc8 20. Nd6 Qc7 21. c5 Nd5 22. Bxd7 Qxd7 23. Nxb7+ Qxb7 24. Qe2 Nxf4 25. gxf4 Re8 26. Qc4 Rxe1+ 27. Rxe1 Qxb2 28. Rf1 Qa3 29. Qg8+ Kc7 30. Qxg7+ Kb8 31. Qxh7 Bxf3 32. Qg8+ Kb7 33. Qf7+ Ka6 34. Qe8 Be4 35. Qc8+ Ka5 36. Qxc6 Qe3+ 37. Rf2 Qe1+
https://www.chess.com/game/live/126794957419	120+1	True	bullet	chess	1002	resigned	998	win	Live Chess	Chess.com	2024-12-01 00:00:00	oli77BB	Rhythmbear1	0-1	5rk1/p2rbppp/1pb1p3/2p1P3/2P2n2/1N3N2/P4PPP/R3R1K1 w - -	UTC	C02	https://www.chess.com/openings/French-Defense-Advance-Paulsen-Euwe-Variation	12:24:25	12:25:35	2024-12-01 00:00:00	e4 e6 Nf3 d5 e5 c5 d4 Nc6 c3 Bd7 Bb5 Nxe5 dxe5 Bxb5 Nbd2 Ne7 b3 Ng6 c4 dxc4 bxc4 Bc6 O-O Be7 Re1 O-O Nb3 b6 Qxd8 Raxd8 Be3 Rd7 Bf4 Nxf4	1. e4 e6 2. Nf3 d5 3. e5 c5 4. d4 Nc6 5. c3 Bd7 6. Bb5 Nxe5 7. dxe5 Bxb5 8. Nbd2 Ne7 9. b3 Ng6 10. c4 dxc4 11. bxc4 Bc6 12. O-O Be7 13. Re1 O-O 14. Nb3 b6 15. Qxd8 Raxd8 16. Be3 Rd7 17. Bf4 Nxf4
https://www.chess.com/game/live/126794970097	120+1	True	bullet	chess	994	win	990	checkmated	Live Chess	Chess.com	2024-12-01 00:00:00	tatatataxii	Rhythmbear1	1-0	6r1/pp1R3p/4kp2/4bQ2/6PP/8/2P1K3/6R1 b - -	UTC	C10	https://www.chess.com/openings/French-Defense-Marshall-Variation	12:25:40	12:31:04	2024-12-01 00:00:00	e4 e6 d4 d5 Nc3 c5 exd5 exd5 dxc5 Bxc5 Qxd5 Qe7+ Be2 Nf6 Bg5 Be6 Bxf6 gxf6 Qd3 Nc6 Ne4 Bb6 O-O-O Bxa2 b3 Rc8 Bg4 Qa3+ Kd2 Rd8 Nxf6+ Kf8 Nd7+ Kg7 Qc3+ Bd4 Qg3 f6 Be6+ Kh6 Qh4+ Kg6 Qg4+ Kh6 Nf3 Rxd7 Bxd7 Qb4+ Ke2 Ne5 Nxe5 Bxe5 Qxb4 Bxb3 Qxb3 Rg8 Bf5 Rg5 Bg4 Rxg4 h3 Rg5 f4 Bxf4 Qf3 Be5 h4 Rg8 g4 Kg7 Rhg1 Kf7 Rd7+ Ke6 Qf5#	1. e4 e6 2. d4 d5 3. Nc3 c5 4. exd5 exd5 5. dxc5 Bxc5 6. Qxd5 Qe7+ 7. Be2 Nf6 8. Bg5 Be6 9. Bxf6 gxf6 10. Qd3 Nc6 11. Ne4 Bb6 12. O-O-O Bxa2 13. b3 Rc8 14. Bg4 Qa3+ 15. Kd2 Rd8 16. Nxf6+ Kf8 17. Nd7+ Kg7 18. Qc3+ Bd4 19. Qg3 f6 20. Be6+ Kh6 21. Qh4+ Kg6 22. Qg4+ Kh6 23. Nf3 Rxd7 24. Bxd7 Qb4+ 25. Ke2 Ne5 26. Nxe5 Bxe5 27. Qxb4 Bxb3 28. Qxb3 Rg8 29. Bf5 Rg5 30. Bg4 Rxg4 31. h3 Rg5 32. f4 Bxf4 33. Qf3 Be5 34. h4 Rg8 35. g4 Kg7 36. Rhg1 Kf7 37. Rd7+ Ke6 38. Qf5# 
https://www.chess.com/game/live/126795025237	120+1	True	bullet	chess	999	win	1019	resigned	Live Chess	Chess.com	2024-12-01 00:00:00	Rhythmbear1	geomeu	1-0	1n3qk1/Q5pp/p7/4Np2/1p6/1P1B4/P1PP2PP/R1B4K b - -	UTC	A06	https://www.chess.com/openings/Reti-Opening-Tennison-Gambit	12:31:11	12:34:17	2024-12-01 00:00:00	e4 d5 Nf3 dxe4 Ne5 Bf5 Bc4 e6 O-O Nf6 f3 Bd6 fxe4 Nxe4 Rxf5 Bc5+ Kh1 Nf2+ Rxf2 Bxf2 Qf3 O-O Qxf2 a6 Nc3 b5 Bd3 c5 b3 b4 Ne4 f5 Nxc5 Ra7 Nxe6 Qe7 Nxf8 Qxf8 Qxa7	1. e4 d5 2. Nf3 dxe4 3. Ne5 Bf5 4. Bc4 e6 5. O-O Nf6 6. f3 Bd6 7. fxe4 Nxe4 8. Rxf5 Bc5+ 9. Kh1 Nf2+ 10. Rxf2 Bxf2 11. Qf3 O-O 12. Qxf2 a6 13. Nc3 b5 14. Bd3 c5 15. b3 b4 16. Ne4 f5 17. Nxc5 Ra7 18. Nxe6 Qe7 19. Nxf8 Qxf8 20. Qxa7 
https://www.chess.com/game/live/126795557617	120+1	True	bullet	chess	991	checkmated	1002	win	Live Chess	Chess.com	2024-12-01 00:00:00	Rhythmbear1	pistoloapete	0-1	r7/ppp2kp1/3p1n2/3Pn1B1/8/7q/PP3b2/R2Q1R1K w - -	UTC	C21	https://www.chess.com/openings/Center-Game-Accepted-Kieseritzky-Variation-3...Bc5	12:34:24	12:36:33	2024-12-01 00:00:00	e4 e5 Nf3 Bc5 d4 exd4 Bc4 d6 c3 dxc3 Bxf7+ Kxf7 Ng5+ Ke7 Nxc3 Be6 Nxh7 Rxh7 Bg5+ Nf6 Nd5+ Bxd5 exd5 Nd7 O-O Kf7 Re1 Ne5 Kh1 Qh8 h3 Bxf2 Rf1 Rxh3+ gxh3 Qxh3#	1. e4 e5 2. Nf3 Bc5 3. d4 exd4 4. Bc4 d6 5. c3 dxc3 6. Bxf7+ Kxf7 7. Ng5+ Ke7 8. Nxc3 Be6 9. Nxh7 Rxh7 10. Bg5+ Nf6 11. Nd5+ Bxd5 12. exd5 Nd7 13. O-O Kf7 14. Re1 Ne5 15. Kh1 Qh8 16. h3 Bxf2 17. Rf1 Rxh3+ 18. gxh3 Qxh3#
[2025-03-10T01:40:45.762+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-12-games.parquet
[2025-03-10T01:40:45.762+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-03-10T01:40:45.772+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-10T01:40:45.772+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-12-01T00:00:00+00:00, execution_date=20241201T000000, start_date=20250310T014041, end_date=20250310T014045
[2025-03-10T01:40:45.812+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-10T01:40:45.838+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-03-10T01:40:45.842+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
