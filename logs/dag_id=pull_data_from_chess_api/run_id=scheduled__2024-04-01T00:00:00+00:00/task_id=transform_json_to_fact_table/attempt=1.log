[2025-02-18T16:42:58.281+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-02-18T16:42:58.319+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [queued]>
[2025-02-18T16:42:58.349+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [queued]>
[2025-02-18T16:42:58.350+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-02-18T16:42:58.399+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-04-01 00:00:00+00:00
[2025-02-18T16:42:58.413+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=3842) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-02-18T16:42:58.417+0000] {standard_task_runner.py:72} INFO - Started process 3843 to run task
[2025-02-18T16:42:58.418+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-04-01T00:00:00+00:00', '--job-id', '222', '--raw', '--subdir', 'DAGS_FOLDER/chess_dag.py', '--cfg-path', '/tmp/tmpj3g4ra2u']
[2025-02-18T16:42:58.420+0000] {standard_task_runner.py:105} INFO - Job 222: Subtask transform_json_to_fact_table
[2025-02-18T16:42:58.536+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [running]> on host 4ed02a11bf8e
[2025-02-18T16:42:58.786+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-04-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-01T00:00:00+00:00'
[2025-02-18T16:42:58.788+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-02-18T16:42:58.851+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-02-18T16:42:58.898+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-02-18T16:43:01.103+0000] {logging_mixin.py:190} INFO - /tmp/tmp04gptjhe
[2025-02-18T16:43:03.684+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-04-games.csv
[2025-02-18T16:43:03.685+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-02-18T16:43:03.704+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-02-18T16:43:03.704+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-04-01T00:00:00+00:00, execution_date=20240401T000000, start_date=20250218T164258, end_date=20250218T164303
[2025-02-18T16:43:03.776+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-02-18T16:43:03.804+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-02-18T16:43:03.809+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-03-10T01:37:52.051+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-10T01:37:52.072+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [queued]>
[2025-03-10T01:37:52.083+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [queued]>
[2025-03-10T01:37:52.084+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-03-10T01:37:52.103+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): transform_json_to_fact_table> on 2024-04-01 00:00:00+00:00
[2025-03-10T01:37:52.110+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=17215) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-03-10T01:37:52.112+0000] {standard_task_runner.py:72} INFO - Started process 17217 to run task
[2025-03-10T01:37:52.113+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'pull_data_from_chess_api', 'transform_json_to_fact_table', 'scheduled__2024-04-01T00:00:00+00:00', '--job-id', '533', '--raw', '--subdir', 'DAGS_FOLDER/collect_chess_data_dag.py', '--cfg-path', '/tmp/tmp_25yrzbq']
[2025-03-10T01:37:52.117+0000] {standard_task_runner.py:105} INFO - Job 533: Subtask transform_json_to_fact_table
[2025-03-10T01:37:52.165+0000] {task_command.py:467} INFO - Running <TaskInstance: pull_data_from_chess_api.transform_json_to_fact_table scheduled__2024-04-01T00:00:00+00:00 [running]> on host 70b3b9cfbba0
[2025-03-10T01:37:52.262+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='pull_data_from_chess_api' AIRFLOW_CTX_TASK_ID='transform_json_to_fact_table' AIRFLOW_CTX_EXECUTION_DATE='2024-04-01T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-04-01T00:00:00+00:00'
[2025-03-10T01:37:52.263+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-10T01:37:52.298+0000] {connection.py:531} ERROR - Unable to retrieve connection from secrets backend (EnvironmentVariablesBackend). Checking subsequent secrets backend.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 526, in get_connection_from_secrets
    conn = secrets_backend.get_connection(conn_id=conn_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 116, in get_connection
    return self.deserialize_connection(conn_id=conn_id, value=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/secrets/base_secrets.py", line 70, in deserialize_connection
    return Connection(conn_id=conn_id, uri=value)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 4, in __init__
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 481, in _initialize_instance
    with util.safe_reraise():
         ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/orm/state.py", line 479, in _initialize_instance
    return manager.original_init(*mixed[1:], **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 169, in __init__
    self._parse_from_uri(uri)
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py", line 257, in _parse_from_uri
    self.port = uri_parts.port
                ^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/urllib/parse.py", line 182, in port
    raise ValueError(f"Port could not be cast to integer value as {port!r}")
ValueError: Port could not be cast to integer value as 'DefaultEndpointsProtocol=https;AccountName=rbchesssa;AccountKey=lG9W+utkpTNorE0rTLlfDMUZsTPleXk6pXv6NnfDTi'
[2025-03-10T01:37:52.315+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_storage'
[2025-03-10T01:37:54.656+0000] {logging_mixin.py:190} INFO - /tmp/tmpjzvavwn2
[2025-03-10T01:37:54.710+0000] {logging_mixin.py:190} INFO - Previewing Dataframe
[2025-03-10T01:37:54.712+0000] {logging_mixin.py:190} INFO - game_url                        object
time_control                    object
rated                             bool
time_class                      object
rules                           object
white_rating                     int64
white_result                    object
black_rating                     int64
black_result                    object
pgn_event                       object
pgn_site                        object
game_date               datetime64[us]
pgn_white_user                  object
pgn_black_user                  object
pgn_result                      object
pgn_current_position            object
pgn_timezone                    object
pgn_eco                         object
pgn_eco_url                     object
start_time                      object
end_time                        object
end_game_date           datetime64[us]
pgn_raw                         object
pgn_trans                       object
dtype: object
[2025-03-10T01:37:54.727+0000] {logging_mixin.py:190} INFO - https://www.chess.com/game/live/105707954303	120+1	True	bullet	chess	715	timeout	752	win	Live Chess	Chess.com	2024-04-01 00:00:00	Rhythmbear1	chamkorsingh84	0-1	r4r1k/2p2Qpp/p7/1n2N1q1/3P2P1/2P4P/PP3PK1/3R4 w - -	UTC	C11	https://www.chess.com/openings/French-Defense-Classical-Delayed-Exchange-Variation	10:53:41	10:58:37	2024-04-01 00:00:00	e4 d5 exd5 Nf6 Nc3 e6 d4 Bb4 dxe6 Bxe6 Bd2 O-O Nf3 Re8 Be2 Bxc3 Bxc3 Bg4 O-O Nc6 h3 Bh5 Nh2 Bxe2 Qd2 Bxf1 Rxf1 Ne4 Qd3 Nxc3 Qxc3 a6 Rd1 Ne7 Nf3 Nf5 g4 Nd6 Ne5 Nb5 Qf3 Rf8 c3 Qg5 Qxb7 Rfb8 Qf3 Rf8 Qd5 Rfd8 Qxf7+ Kh8 Kg2 Rf8	1. e4 d5 2. exd5 Nf6 3. Nc3 e6 4. d4 Bb4 5. dxe6 Bxe6 6. Bd2 O-O 7. Nf3 Re8 8. Be2 Bxc3 9. Bxc3 Bg4 10. O-O Nc6 11. h3 Bh5 12. Nh2 Bxe2 13. Qd2 Bxf1 14. Rxf1 Ne4 15. Qd3 Nxc3 16. Qxc3 a6 17. Rd1 Ne7 18. Nf3 Nf5 19. g4 Nd6 20. Ne5 Nb5 21. Qf3 Rf8 22. c3 Qg5 23. Qxb7 Rfb8 24. Qf3 Rf8 25. Qd5 Rfd8 26. Qxf7+ Kh8 27. Kg2 Rf8
https://www.chess.com/game/live/105708040573	120+1	True	bullet	chess	681	checkmated	722	win	Live Chess	Chess.com	2024-04-01 00:00:00	Davigaming	Rhythmbear1	0-1	r4rk1/1p4pp/p3pn2/1bbp4/6q1/4K3/2BB1PPP/2RQR3 w - -	UTC	C02	https://www.chess.com/openings/French-Defense-Advance-Paulsen-Euwe-Variation	10:59:37	11:03:01	2024-04-01 00:00:00	e4 e6 d4 d5 e5 c5 c3 Bd7 Nf3 Nc6 Bg5 f6 exf6 Nxf6 Ne5 Be7 Nxc6 Bxc6 Na3 cxd4 cxd4 O-O Nb5 Qb6 a4 a6 Nc3 Qxb2 Bd3 Qxc3+ Ke2 Bd6 Rc1 Qb4 Bd2 Qxa4 Bc2 Qxd4 Re1 Bb5+ Kf3 Qg4+ Ke3 Bc5#	1. e4 e6 2. d4 d5 3. e5 c5 4. c3 Bd7 5. Nf3 Nc6 6. Bg5 f6 7. exf6 Nxf6 8. Ne5 Be7 9. Nxc6 Bxc6 10. Na3 cxd4 11. cxd4 O-O 12. Nb5 Qb6 13. a4 a6 14. Nc3 Qxb2 15. Bd3 Qxc3+ 16. Ke2 Bd6 17. Rc1 Qb4 18. Bd2 Qxa4 19. Bc2 Qxd4 20. Re1 Bb5+ 21. Kf3 Qg4+ 22. Ke3 Bc5#
https://www.chess.com/game/live/105708549485	120+1	True	bullet	chess	711	resigned	619	win	Live Chess	Chess.com	2024-04-01 00:00:00	Rhythmbear1	AnanthuViswanath	0-1	2q4k/6pp/1Q1R1b2/4N3/4P3/1Pp5/2P2PPP/r5K1 w - -	UTC	C41	https://www.chess.com/openings/Philidor-Defense-Exchange-Morphy-Gambit	11:03:21	11:06:36	2024-04-01 00:00:00	e4 e5 Nf3 d6 d4 exd4 Bc4 Be6 Bxe6 fxe6 Nxd4 e5 Nf3 Nf6 Nc3 Be7 O-O O-O Bg5 Nc6 Bxf6 Bxf6 Qd5+ Kh8 Rad1 Nb4 Qb3 a5 Nd5 c6 Nxb4 axb4 Qxb4 c5 Qb3 b6 a3 Qc8 Rxd6 Rd8 Rfd1 Rxd6 Rxd6 c4 Qxb6 c3 b3 Rxa3 Nxe5 Ra1+	1. e4 e5 2. Nf3 d6 3. d4 exd4 4. Bc4 Be6 5. Bxe6 fxe6 6. Nxd4 e5 7. Nf3 Nf6 8. Nc3 Be7 9. O-O O-O 10. Bg5 Nc6 11. Bxf6 Bxf6 12. Qd5+ Kh8 13. Rad1 Nb4 14. Qb3 a5 15. Nd5 c6 16. Nxb4 axb4 17. Qxb4 c5 18. Qb3 b6 19. a3 Qc8 20. Rxd6 Rd8 21. Rfd1 Rxd6 22. Rxd6 c4 23. Qxb6 c3 24. b3 Rxa3 25. Nxe5 Ra1+
https://www.chess.com/game/live/105708598331	120+1	True	bullet	chess	706	timeout	841	win	Live Chess	Chess.com	2024-04-01 00:00:00	Rhythmbear1	amaaderboy	0-1	5Q2/p1pp2pk/1p5p/8/3Pb1qP/2P3P1/P4P1K/R3R3 w - -	UTC	C54	https://www.chess.com/openings/Giuoco-Piano-Game-Center-Attack-Greco-Attack	11:06:43	11:12:01	2024-04-01 00:00:00	e4 e5 Nf3 Nc6 d4 exd4 Bc4 Bc5 c3 Nf6 cxd4 Bb4+ Nc3 Bxc3+ bxc3 Nxe4 Qe2 Qe7 O-O Nf6 Qb2 b6 Re1 Ne4 Ng5 O-O Rxe4 Qf6 Re1 Bb7 Bd3 h6 Nf3 Rfe8 Be3 Ne7 Be2 Ng6 Qb3 Nf4 Bxf4 Qxf4 Ne5 Qg5 Qxf7+ Kh8 Bf3 Rf8 Ng6+ Kh7 Nxf8+ Rxf8 Qxf8 Bxf3 g3 Qh5 h4 Qg4 Kh2 Be4	1. e4 e5 2. Nf3 Nc6 3. d4 exd4 4. Bc4 Bc5 5. c3 Nf6 6. cxd4 Bb4+ 7. Nc3 Bxc3+ 8. bxc3 Nxe4 9. Qe2 Qe7 10. O-O Nf6 11. Qb2 b6 12. Re1 Ne4 13. Ng5 O-O 14. Rxe4 Qf6 15. Re1 Bb7 16. Bd3 h6 17. Nf3 Rfe8 18. Be3 Ne7 19. Be2 Ng6 20. Qb3 Nf4 21. Bxf4 Qxf4 22. Ne5 Qg5 23. Qxf7+ Kh8 24. Bf3 Rf8 25. Ng6+ Kh7 26. Nxf8+ Rxf8 27. Qxf8 Bxf3 28. g3 Qh5 29. h4 Qg4 30. Kh2 Be4
https://www.chess.com/game/live/105708677541	120+1	True	bullet	chess	789	resigned	716	win	Live Chess	Chess.com	2024-04-01 00:00:00	ganesansatish	Rhythmbear1	0-1	5r1k/p5p1/1p4p1/3pP3/1P3P1P/P2b2q1/1K1n4/R6R w - -	UTC	C02	https://www.chess.com/openings/French-Defense-Advance-Paulsen-Euwe-Variation-6.Be2-Nge7	11:12:07	11:15:50	2024-04-01 00:00:00	e4 e6 d4 d5 e5 c5 c3 Bd7 Nf3 Nc6 Be2 Nge7 Be3 cxd4 cxd4 Ng6 Bd3 Be7 Bxg6 fxg6 Nc3 O-O a3 Qb6 b4 Rac8 Na4 Qd8 O-O h6 Qd2 Kh7 Nc5 b6 Nd3 Bg5 Bxg5 hxg5 Nxg5+ Kh8 f4 Rf5 Nf2 Ne7 g4 Rf8 h4 Bb5 Nxe6 Qd7 Nxf8 Rxf8 Nd3 Qxg4+ Kf2 Nf5 Rh1 Qg3+ Ke2 Nxd4+ Kd1 Bxd3 Kc1 Nb3+ Kb2 Nxd2	1. e4 e6 2. d4 d5 3. e5 c5 4. c3 Bd7 5. Nf3 Nc6 6. Be2 Nge7 7. Be3 cxd4 8. cxd4 Ng6 9. Bd3 Be7 10. Bxg6 fxg6 11. Nc3 O-O 12. a3 Qb6 13. b4 Rac8 14. Na4 Qd8 15. O-O h6 16. Qd2 Kh7 17. Nc5 b6 18. Nd3 Bg5 19. Bxg5 hxg5 20. Nxg5+ Kh8 21. f4 Rf5 22. Nf2 Ne7 23. g4 Rf8 24. h4 Bb5 25. Nxe6 Qd7 26. Nxf8 Rxf8 27. Nd3 Qxg4+ 28. Kf2 Nf5 29. Rh1 Qg3+ 30. Ke2 Nxd4+ 31. Kd1 Bxd3 32. Kc1 Nb3+ 33. Kb2 Nxd2
[2025-03-10T01:37:55.354+0000] {logging_mixin.py:190} INFO - Successfully Transformed Data and Loaded to Azure Storage as silver/fact-2024-04-games.parquet
[2025-03-10T01:37:55.355+0000] {python.py:240} INFO - Done. Returned value was: None
[2025-03-10T01:37:55.367+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-10T01:37:55.368+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=pull_data_from_chess_api, task_id=transform_json_to_fact_table, run_id=scheduled__2024-04-01T00:00:00+00:00, execution_date=20240401T000000, start_date=20250310T013752, end_date=20250310T013755
[2025-03-10T01:37:55.425+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-10T01:37:55.458+0000] {taskinstance.py:3900} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-03-10T01:37:55.461+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
