[2025-03-26T02:36:55.073+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-26T02:36:55.123+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: load_data_warehouse.load_fact_table_to_postgres manual__2025-03-12T14:13:58.419334+00:00 [queued]>
[2025-03-26T02:36:55.147+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: load_data_warehouse.load_fact_table_to_postgres manual__2025-03-12T14:13:58.419334+00:00 [queued]>
[2025-03-26T02:36:55.148+0000] {taskinstance.py:2865} INFO - Starting attempt 3 of 4
[2025-03-26T02:36:55.177+0000] {taskinstance.py:2888} INFO - Executing <Task(PythonOperator): load_fact_table_to_postgres> on 2025-03-12 14:13:58.419334+00:00
[2025-03-26T02:36:55.190+0000] {warnings.py:112} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=30268) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2025-03-26T02:36:55.194+0000] {standard_task_runner.py:72} INFO - Started process 30277 to run task
[2025-03-26T02:36:55.195+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'load_data_warehouse', 'load_fact_table_to_postgres', 'manual__2025-03-12T14:13:58.419334+00:00', '--job-id', '773', '--raw', '--subdir', 'DAGS_FOLDER/load_data_warehouse_dag.py', '--cfg-path', '/tmp/tmpsu24h4u0']
[2025-03-26T02:36:55.201+0000] {standard_task_runner.py:105} INFO - Job 773: Subtask load_fact_table_to_postgres
[2025-03-26T02:36:55.292+0000] {task_command.py:467} INFO - Running <TaskInstance: load_data_warehouse.load_fact_table_to_postgres manual__2025-03-12T14:13:58.419334+00:00 [running]> on host 8de4e0a4beb2
[2025-03-26T02:36:55.478+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='load_data_warehouse' AIRFLOW_CTX_TASK_ID='load_fact_table_to_postgres' AIRFLOW_CTX_EXECUTION_DATE='2025-03-12T14:13:58.419334+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-03-12T14:13:58.419334+00:00'
[2025-03-26T02:36:55.480+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-26T02:36:59.727+0000] {logging_mixin.py:190} INFO - âœ… DataFrame Loaded: 491 rows, 15 columns
[2025-03-26T02:36:59.748+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_dw'
[2025-03-26T02:36:59.787+0000] {base.py:84} INFO - Retrieving connection 'azure_chess_dw'
[2025-03-26T02:37:06.565+0000] {taskinstance.py:3310} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "game_date" of relation "fact_games" does not exist
LINE 1: INSERT INTO chess_dw.fact_games (game_url, game_date, start_...
                                                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/scripts/python_scripts.py", line 711, in load_fact_to_postgres
    fact.to_sql(name='fact_games',
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "game_date" of relation "fact_games" does not exist
LINE 1: INSERT INTO chess_dw.fact_games (game_url, game_date, start_...
                                                   ^

[SQL: INSERT INTO chess_dw.fact_games (game_url, game_date, start_time, end_time, game_duration_secs, time_control, my_color, my_rating, opponent_rating, my_result, opponent_result, game_fen, opening_url, game_pgn, last_updated) VALUES (%(game_url)s, %(game_date)s, %(start_time)s, %(end_time)s, %(game_duration_secs)s, %(time_control)s, %(my_color)s, %(my_rating)s, %(opponent_rating)s, %(my_result)s, %(opponent_result)s, %(game_fen)s, %(opening_url)s, %(game_pgn)s, %(last_updated)s)]
[parameters: ({'game_url': 'https://www.chess.com/game/live/123002819534', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 2, 4, 27), 'end_time': datetime.datetime(2025, 2, 18, 2, 7, 46), 'game_duration_secs': 199, 'time_control': '2|1', 'my_color': 'white', 'my_rating': 959, 'opponent_rating': 989, 'my_result': 'win', 'opponent_result': 'abandoned', 'game_fen': 'r2q1rn1/2p5/pp1p2kp/4PR1n/3b4/P1NB3Q/1PPB2PP/R6K b - -', 'opening_url': 'https://www.chess.com/openings/Pirc-Defense-Small-Center-Defense', 'game_pgn': '1. e4 d6 2. d4 e6 3. Nc3 Ne7 4. f4 Nd7 5. Bd3 g6 6. Nf3 h6 7. O-O Bg7 8. Bd2 a6 9. a3 b6 10. Qe1 Bb7 11. Qg3 O-O 12. Qh3 Kh7 13. Ng5+ Kg8 14. Nxe6 fxe6 15. Qxe6+ Kh7 16. Qg4 Nf6 17. Qg3 Nh5 18. Qh3 Bxd4+ 19. Kh1 Bc8 20. f5 Ng8 21. fxg6+ Kxg6 22. e5+ Bf5 23. Rxf5 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123010626626', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 8, 49, 20), 'end_time': datetime.datetime(2025, 2, 18, 8, 53, 38), 'game_duration_secs': 258, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 951, 'opponent_rating': 930, 'my_result': 'win', 'opponent_result': 'timeout', 'game_fen': 'r4r1k/pppq2bp/2bp2p1/5pB1/1PNPn3/2P2N1P/P4PP1/R2QR1K1 w - -', 'opening_url': 'https://www.chess.com/openings/Modern-Defense-with-1-e4', 'game_pgn': '1. e4 g6 2. e5 Bg7 3. d4 d6 4. exd6 exd6 5. c3 Ne7 6. Nf3 Nf5 7. Bd3 O-O 8. Bg5 f6 9. Bd2 Nc6 10. O-O Bd7 11. Re1 Nh6 12. Nh4 f5 13. Nf3 Ng4 14. Bf4 Ne7 15. Bc4+ Kh8 16. h3 Nh6 17. Ng5 Neg8 18. Nf3 Nf7 19. Nbd2 Bc6 20. Be6 Nfh6 21. Bxg8 Nxg8 22. Bg5 Nf6 23. b4 Qd7 24. Nc4 Ne4', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049303274', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 1, 59), 'end_time': datetime.datetime(2025, 2, 19, 10, 5, 27), 'game_duration_secs': 208, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1302, 'opponent_rating': 1306, 'my_result': 'win', 'opponent_result': 'resigned', 'game_fen': '2r3k1/p3r2p/5Bp1/1pp5/3p4/P4P2/1PPR2PP/3R2K1 w - -', 'opening_url': 'https://www.chess.com/openings/Kings-Pawn-Opening-Kings-Head-Opening', 'game_pgn': '1. e4 e5 2. f3 Nc6 3. d4 exd4 4. Bc4 Qe7 5. Ne2 d6 6. Nxd4 Nxd4 7. Qxd4 Be6 8. Nd2 Bxc4 9. Nxc4 Nf6 10. Bf4 Qd7 11. O-O Be7 12. Rad1 Nh5 13. Be3 O-O  ... (23 characters truncated) ... 8 16. a3 c5 17. Qd5 Nf6 18. Qxe6 fxe6 19. Rd2 Rd7 20. Rfd1 Rad8 21. Nc4 b5 22. Na5 d5 23. Nc6 Rc8 24. exd5 exd5 25. Nxe7+ Rxe7 26. Bh4 d4 27. Bxf6 g6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049832654', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 23, 9), 'end_time': datetime.datetime(2025, 2, 19, 10, 34, 29), 'game_duration_secs': 680, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1303, 'opponent_rating': 1305, 'my_result': 'insufficient', 'opponent_result': 'insufficient', 'game_fen': '8/8/8/8/8/6kN/3K4/8 b - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Queens-Knight-Variation-2...d5', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. Qf3 c6 5. d4 Bd6 6. Bd3 Ne7 7. Bd2 O-O 8. O-O-O Nd7 9. h4 Nf6 10. Re1 Bg4 11. Qe3 Re8 12. f3 Bg3 13. fxg4 Bxe1 14. ... (625 characters truncated) ... e2+ 65. Ka3 Kg3 66. Nxa4 Re5 67. Kb3 Kg4 68. Nc3 Rxg5 69. hxg5 Kxg5 70. Ne2 Kg4 71. Kc3 h4 72. Kd2 Kf3 73. Ng1+ Kg2 74. Ne2 h3 75. Nf4+ Kg3 76. Nxh3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123092292140', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 13, 50, 4), 'end_time': datetime.datetime(2025, 2, 20, 13, 57, 38), 'game_duration_secs': 454, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1282, 'opponent_rating': 1303, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '8/5k1p/8/5p2/1P3P2/P7/3q1QKP/8 b - -', 'opening_url': 'https://www.chess.com/openings/Queens-Gambit-Accepted-Old-Variation...4.Bxc4-exd4-5.exd4-Bd6-6.Nf3', 'game_pgn': '1. e4 e6 2. Nf3 d5 3. exd5 exd5 4. d4 Bd6 5. c4 dxc4 6. Bxc4 Ne7 7. Ng5 O-O 8. Qf3 Be6 9. Bxe6 fxe6 10. Qxb7 Nbc6 11. Nxe6 Bb4+ 12. Bd2 Bxd2+ 13. Nxd ... (132 characters truncated) ...  Qc7 Nd4 25. Qxa7 Ndf5 26. Rc7 Re8 27. Re1 g6 28. g4 Kf7 29. gxf5 gxf5 30. Rexe7+ Rxe7 31. Rxe7+ Qxe7 32. Qc5 Qe4+ 33. Kg1 Qe1+ 34. Kg2 Qd2+ 35. Qf2 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123098362392', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 16, 50, 20), 'end_time': datetime.datetime(2025, 2, 20, 16, 56, 58), 'game_duration_secs': 398, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1269, 'opponent_rating': 1423, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': 'r4rk1/pp1N1pp1/2p1b3/8/3P2Q1/8/1q4PP/R4R1K w - -', 'opening_url': 'https://www.chess.com/openings/Sicilian-Defense-McDonnell-Attack-2...Nc6-3.Nf3-e6-4.Bb5', 'game_pgn': '1. e4 c5 2. f4 e6 3. Nf3 Nc6 4. Bb5 Qb6 5. Bxc6 dxc6 6. O-O Nf6 7. d3 Be7 8. Nc3 c4+ 9. Kh1 cxd3 10. cxd3 O-O 11. Qe2 Bc5 12. Na4 Qa5 13. Nxc5 Qxc5 1 ... (9 characters truncated) ... 5 15. Ne5 Nxe4 16. Qg4 Nf6 17. Qg5 h6 18. Qg3 Qxb2 19. f5 exf5 20. Bxh6 Nh5 21. Qe3 f4 22. Bxf4 Nxf4 23. Qxf4 Be6 24. d4 Bd5 25. Qg4 Bxa2 26. Nd7 Be6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123101248120', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 18, 14, 35), 'end_time': datetime.datetime(2025, 2, 20, 18, 18, 18), 'game_duration_secs': 223, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 944, 'opponent_rating': 949, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': 'r3r2k/4PQpp/1pR2p2/2np4/8/8/5PPP/3q2K1 w - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Kings-Indian-Attack-2...d5', 'game_pgn': '1. e4 e6 2. d3 d5 3. exd5 exd5 4. Nf3 Bc5 5. Be2 Ne7 6. O-O O-O 7. Nc3 c6 8. Bf4 Bg4 9. d4 Bd6 10. Bxd6 Qxd6 11. Ne5 Bxe2 12. Qxe2 Re8 13. Qg4 Ng6 14. Rfe1 Nxe5 15. dxe5 Qc5 16. e6 f6 17. Na4 Qxc2 18. b3 b6 19. e7 Na6 20. Rac1 Qxa2 21. Rxc6 Qxb3 22. Nxb6 axb6 23. Qe6+ Kh8 24. Qf7 Nc5 25. Rd1 Qxd1#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123104732000', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 20, 2, 6), 'end_time': datetime.datetime(2025, 2, 20, 20, 6, 35), 'game_duration_secs': 269, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 938, 'opponent_rating': 942, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '5rk1/5ppp/1p2pn2/p1p5/3p4/PP1P1BQ1/R1P1qP2/2B2RK1 b - -', 'opening_url': 'https://www.chess.com/openings/Nimzowitsch-Larsen-Attack-Classical-Variation-2.Bb2-e6', 'game_pgn': '1. b3 e6 2. Bb2 d5 3. g3 Nf6 4. Bg2 Bd6 5. d3 O-O 6. Nd2 b6 7. e3 Bb7 8. Ne2 Nbd7 9. a3 c5 10. h3 d4 11. e4 Bc7 12. Nf3 Nh5 13. g4 Nf4 14. Nxf4 Bxf4  ... (9 characters truncated) ... xh4 16. Qe2 Nf6 17. O-O Nd7 18. Qf3 Bc7 19. Qg3 Qg5 20. Qxc7 Bxe4 21. Bxe4 Nf6 22. Bc1 Qh4 23. Bxa8 Qxh3 24. Bg2 Qxg4 25. Qg3 Qe2 26. Ra2 a5 27. Bf3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}  ... displaying 10 of 491 total bound parameter sets ...  {'game_url': 'https://www.chess.com/game/live/132363662425', 'game_date': datetime.datetime(2025, 2, 3, 0, 0), 'start_time': datetime.datetime(2025, 2, 3, 23, 21, 40), 'end_time': datetime.datetime(2025, 2, 3, 23, 35, 46), 'game_duration_secs': 846, 'time_control': '10', 'my_color': 'white', 'my_rating': 1491, 'opponent_rating': 1488, 'my_result': 'checkmated', 'opponent_result': 'win', 'game_fen': '8/1ppkr1p1/p2p3p/3P1KrP/2P2R2/8/1P3R2/8 w - - 0 37', 'opening_url': 'https://www.chess.com/openings/Italian-Game-3...d6-4.d4-exd4', 'game_pgn': '1. e4 e5 2. Nf3 Nc6 3. d4 exd4 4. Bc4 d6 5. O-O Bg4 6. Qd3 Bxf3 7. Qxf3 Qf6 8. Qb3 O-O-O 9. Bxf7 Nge7 10. Bd5 Nxd5 11. exd5 Ne7 12. a4 Qf7 13. c4 Nf5 ... (136 characters truncated) ... 4+ 25. Rxd4 Re8 26. Rdf4 Kd7 27. Kh2 Rb3 28. R1f2 Re7 29. h4 Rb4 30. h5 h6 31. g4 Ra4 32. Kh3 Rxa5 33. Kh4 Ra1 34. g5 Rh1+ 35. Kg4 Rg1+ 36. Kf5 Rxg5#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/132408669035', 'game_date': datetime.datetime(2025, 2, 4, 0, 0), 'start_time': datetime.datetime(2025, 2, 4, 11, 50, 36), 'end_time': datetime.datetime(2025, 2, 4, 11, 59, 8), 'game_duration_secs': 512, 'time_control': '10', 'my_color': 'black', 'my_rating': 1501, 'opponent_rating': 1478, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': '6k1/7p/5p1P/2pp1P2/3r4/3qK3/1r6/8 w - - 4 55', 'opening_url': 'https://www.chess.com/openings/French-Defense-Exchange-Variation-3...exd5-4.Nc3', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. d4 c6 5. Nf3 Bd6 6. Bd3 Ne7 7. Bg5 Bf5 8. Bxe7 Qxe7+ 9. Ne2 Bxd3 10. Qxd3 O-O 11. O-O Nd7 12. Rfe1 Qd8 13. Nc3 Qc7 ... (351 characters truncated) ... 4 43. g5 Rh2 44. gxf6 gxf6 45. Kf4 b3 46. Kg3 Rd2 47. h5 Rxd3+ 48. Kf4 Rxd4+ 49. Ke3 c5 50. h6 b2 51. Kf3 Rb3+ 52. Ke2 b1=Q 53. Kf2 Rb2+ 54. Ke3 Qd3#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)})]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-03-26T02:37:06.629+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=load_data_warehouse, task_id=load_fact_table_to_postgres, run_id=manual__2025-03-12T14:13:58.419334+00:00, execution_date=20250312T141358, start_date=20250326T023655, end_date=20250326T023706
[2025-03-26T02:37:06.682+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-26T02:37:06.684+0000] {standard_task_runner.py:124} ERROR - Failed to execute job 773 for task load_fact_table_to_postgres ((psycopg2.errors.UndefinedColumn) column "game_date" of relation "fact_games" does not exist
LINE 1: INSERT INTO chess_dw.fact_games (game_url, game_date, start_...
                                                   ^

[SQL: INSERT INTO chess_dw.fact_games (game_url, game_date, start_time, end_time, game_duration_secs, time_control, my_color, my_rating, opponent_rating, my_result, opponent_result, game_fen, opening_url, game_pgn, last_updated) VALUES (%(game_url)s, %(game_date)s, %(start_time)s, %(end_time)s, %(game_duration_secs)s, %(time_control)s, %(my_color)s, %(my_rating)s, %(opponent_rating)s, %(my_result)s, %(opponent_result)s, %(game_fen)s, %(opening_url)s, %(game_pgn)s, %(last_updated)s)]
[parameters: ({'game_url': 'https://www.chess.com/game/live/123002819534', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 2, 4, 27), 'end_time': datetime.datetime(2025, 2, 18, 2, 7, 46), 'game_duration_secs': 199, 'time_control': '2|1', 'my_color': 'white', 'my_rating': 959, 'opponent_rating': 989, 'my_result': 'win', 'opponent_result': 'abandoned', 'game_fen': 'r2q1rn1/2p5/pp1p2kp/4PR1n/3b4/P1NB3Q/1PPB2PP/R6K b - -', 'opening_url': 'https://www.chess.com/openings/Pirc-Defense-Small-Center-Defense', 'game_pgn': '1. e4 d6 2. d4 e6 3. Nc3 Ne7 4. f4 Nd7 5. Bd3 g6 6. Nf3 h6 7. O-O Bg7 8. Bd2 a6 9. a3 b6 10. Qe1 Bb7 11. Qg3 O-O 12. Qh3 Kh7 13. Ng5+ Kg8 14. Nxe6 fxe6 15. Qxe6+ Kh7 16. Qg4 Nf6 17. Qg3 Nh5 18. Qh3 Bxd4+ 19. Kh1 Bc8 20. f5 Ng8 21. fxg6+ Kxg6 22. e5+ Bf5 23. Rxf5 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123010626626', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 8, 49, 20), 'end_time': datetime.datetime(2025, 2, 18, 8, 53, 38), 'game_duration_secs': 258, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 951, 'opponent_rating': 930, 'my_result': 'win', 'opponent_result': 'timeout', 'game_fen': 'r4r1k/pppq2bp/2bp2p1/5pB1/1PNPn3/2P2N1P/P4PP1/R2QR1K1 w - -', 'opening_url': 'https://www.chess.com/openings/Modern-Defense-with-1-e4', 'game_pgn': '1. e4 g6 2. e5 Bg7 3. d4 d6 4. exd6 exd6 5. c3 Ne7 6. Nf3 Nf5 7. Bd3 O-O 8. Bg5 f6 9. Bd2 Nc6 10. O-O Bd7 11. Re1 Nh6 12. Nh4 f5 13. Nf3 Ng4 14. Bf4 Ne7 15. Bc4+ Kh8 16. h3 Nh6 17. Ng5 Neg8 18. Nf3 Nf7 19. Nbd2 Bc6 20. Be6 Nfh6 21. Bxg8 Nxg8 22. Bg5 Nf6 23. b4 Qd7 24. Nc4 Ne4', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049303274', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 1, 59), 'end_time': datetime.datetime(2025, 2, 19, 10, 5, 27), 'game_duration_secs': 208, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1302, 'opponent_rating': 1306, 'my_result': 'win', 'opponent_result': 'resigned', 'game_fen': '2r3k1/p3r2p/5Bp1/1pp5/3p4/P4P2/1PPR2PP/3R2K1 w - -', 'opening_url': 'https://www.chess.com/openings/Kings-Pawn-Opening-Kings-Head-Opening', 'game_pgn': '1. e4 e5 2. f3 Nc6 3. d4 exd4 4. Bc4 Qe7 5. Ne2 d6 6. Nxd4 Nxd4 7. Qxd4 Be6 8. Nd2 Bxc4 9. Nxc4 Nf6 10. Bf4 Qd7 11. O-O Be7 12. Rad1 Nh5 13. Be3 O-O  ... (23 characters truncated) ... 8 16. a3 c5 17. Qd5 Nf6 18. Qxe6 fxe6 19. Rd2 Rd7 20. Rfd1 Rad8 21. Nc4 b5 22. Na5 d5 23. Nc6 Rc8 24. exd5 exd5 25. Nxe7+ Rxe7 26. Bh4 d4 27. Bxf6 g6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049832654', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 23, 9), 'end_time': datetime.datetime(2025, 2, 19, 10, 34, 29), 'game_duration_secs': 680, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1303, 'opponent_rating': 1305, 'my_result': 'insufficient', 'opponent_result': 'insufficient', 'game_fen': '8/8/8/8/8/6kN/3K4/8 b - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Queens-Knight-Variation-2...d5', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. Qf3 c6 5. d4 Bd6 6. Bd3 Ne7 7. Bd2 O-O 8. O-O-O Nd7 9. h4 Nf6 10. Re1 Bg4 11. Qe3 Re8 12. f3 Bg3 13. fxg4 Bxe1 14. ... (625 characters truncated) ... e2+ 65. Ka3 Kg3 66. Nxa4 Re5 67. Kb3 Kg4 68. Nc3 Rxg5 69. hxg5 Kxg5 70. Ne2 Kg4 71. Kc3 h4 72. Kd2 Kf3 73. Ng1+ Kg2 74. Ne2 h3 75. Nf4+ Kg3 76. Nxh3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123092292140', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 13, 50, 4), 'end_time': datetime.datetime(2025, 2, 20, 13, 57, 38), 'game_duration_secs': 454, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1282, 'opponent_rating': 1303, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '8/5k1p/8/5p2/1P3P2/P7/3q1QKP/8 b - -', 'opening_url': 'https://www.chess.com/openings/Queens-Gambit-Accepted-Old-Variation...4.Bxc4-exd4-5.exd4-Bd6-6.Nf3', 'game_pgn': '1. e4 e6 2. Nf3 d5 3. exd5 exd5 4. d4 Bd6 5. c4 dxc4 6. Bxc4 Ne7 7. Ng5 O-O 8. Qf3 Be6 9. Bxe6 fxe6 10. Qxb7 Nbc6 11. Nxe6 Bb4+ 12. Bd2 Bxd2+ 13. Nxd ... (132 characters truncated) ...  Qc7 Nd4 25. Qxa7 Ndf5 26. Rc7 Re8 27. Re1 g6 28. g4 Kf7 29. gxf5 gxf5 30. Rexe7+ Rxe7 31. Rxe7+ Qxe7 32. Qc5 Qe4+ 33. Kg1 Qe1+ 34. Kg2 Qd2+ 35. Qf2 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123098362392', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 16, 50, 20), 'end_time': datetime.datetime(2025, 2, 20, 16, 56, 58), 'game_duration_secs': 398, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1269, 'opponent_rating': 1423, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': 'r4rk1/pp1N1pp1/2p1b3/8/3P2Q1/8/1q4PP/R4R1K w - -', 'opening_url': 'https://www.chess.com/openings/Sicilian-Defense-McDonnell-Attack-2...Nc6-3.Nf3-e6-4.Bb5', 'game_pgn': '1. e4 c5 2. f4 e6 3. Nf3 Nc6 4. Bb5 Qb6 5. Bxc6 dxc6 6. O-O Nf6 7. d3 Be7 8. Nc3 c4+ 9. Kh1 cxd3 10. cxd3 O-O 11. Qe2 Bc5 12. Na4 Qa5 13. Nxc5 Qxc5 1 ... (9 characters truncated) ... 5 15. Ne5 Nxe4 16. Qg4 Nf6 17. Qg5 h6 18. Qg3 Qxb2 19. f5 exf5 20. Bxh6 Nh5 21. Qe3 f4 22. Bxf4 Nxf4 23. Qxf4 Be6 24. d4 Bd5 25. Qg4 Bxa2 26. Nd7 Be6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123101248120', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 18, 14, 35), 'end_time': datetime.datetime(2025, 2, 20, 18, 18, 18), 'game_duration_secs': 223, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 944, 'opponent_rating': 949, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': 'r3r2k/4PQpp/1pR2p2/2np4/8/8/5PPP/3q2K1 w - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Kings-Indian-Attack-2...d5', 'game_pgn': '1. e4 e6 2. d3 d5 3. exd5 exd5 4. Nf3 Bc5 5. Be2 Ne7 6. O-O O-O 7. Nc3 c6 8. Bf4 Bg4 9. d4 Bd6 10. Bxd6 Qxd6 11. Ne5 Bxe2 12. Qxe2 Re8 13. Qg4 Ng6 14. Rfe1 Nxe5 15. dxe5 Qc5 16. e6 f6 17. Na4 Qxc2 18. b3 b6 19. e7 Na6 20. Rac1 Qxa2 21. Rxc6 Qxb3 22. Nxb6 axb6 23. Qe6+ Kh8 24. Qf7 Nc5 25. Rd1 Qxd1#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123104732000', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 20, 2, 6), 'end_time': datetime.datetime(2025, 2, 20, 20, 6, 35), 'game_duration_secs': 269, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 938, 'opponent_rating': 942, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '5rk1/5ppp/1p2pn2/p1p5/3p4/PP1P1BQ1/R1P1qP2/2B2RK1 b - -', 'opening_url': 'https://www.chess.com/openings/Nimzowitsch-Larsen-Attack-Classical-Variation-2.Bb2-e6', 'game_pgn': '1. b3 e6 2. Bb2 d5 3. g3 Nf6 4. Bg2 Bd6 5. d3 O-O 6. Nd2 b6 7. e3 Bb7 8. Ne2 Nbd7 9. a3 c5 10. h3 d4 11. e4 Bc7 12. Nf3 Nh5 13. g4 Nf4 14. Nxf4 Bxf4  ... (9 characters truncated) ... xh4 16. Qe2 Nf6 17. O-O Nd7 18. Qf3 Bc7 19. Qg3 Qg5 20. Qxc7 Bxe4 21. Bxe4 Nf6 22. Bc1 Qh4 23. Bxa8 Qxh3 24. Bg2 Qxg4 25. Qg3 Qe2 26. Ra2 a5 27. Bf3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}  ... displaying 10 of 491 total bound parameter sets ...  {'game_url': 'https://www.chess.com/game/live/132363662425', 'game_date': datetime.datetime(2025, 2, 3, 0, 0), 'start_time': datetime.datetime(2025, 2, 3, 23, 21, 40), 'end_time': datetime.datetime(2025, 2, 3, 23, 35, 46), 'game_duration_secs': 846, 'time_control': '10', 'my_color': 'white', 'my_rating': 1491, 'opponent_rating': 1488, 'my_result': 'checkmated', 'opponent_result': 'win', 'game_fen': '8/1ppkr1p1/p2p3p/3P1KrP/2P2R2/8/1P3R2/8 w - - 0 37', 'opening_url': 'https://www.chess.com/openings/Italian-Game-3...d6-4.d4-exd4', 'game_pgn': '1. e4 e5 2. Nf3 Nc6 3. d4 exd4 4. Bc4 d6 5. O-O Bg4 6. Qd3 Bxf3 7. Qxf3 Qf6 8. Qb3 O-O-O 9. Bxf7 Nge7 10. Bd5 Nxd5 11. exd5 Ne7 12. a4 Qf7 13. c4 Nf5 ... (136 characters truncated) ... 4+ 25. Rxd4 Re8 26. Rdf4 Kd7 27. Kh2 Rb3 28. R1f2 Re7 29. h4 Rb4 30. h5 h6 31. g4 Ra4 32. Kh3 Rxa5 33. Kh4 Ra1 34. g5 Rh1+ 35. Kg4 Rg1+ 36. Kf5 Rxg5#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/132408669035', 'game_date': datetime.datetime(2025, 2, 4, 0, 0), 'start_time': datetime.datetime(2025, 2, 4, 11, 50, 36), 'end_time': datetime.datetime(2025, 2, 4, 11, 59, 8), 'game_duration_secs': 512, 'time_control': '10', 'my_color': 'black', 'my_rating': 1501, 'opponent_rating': 1478, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': '6k1/7p/5p1P/2pp1P2/3r4/3qK3/1r6/8 w - - 4 55', 'opening_url': 'https://www.chess.com/openings/French-Defense-Exchange-Variation-3...exd5-4.Nc3', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. d4 c6 5. Nf3 Bd6 6. Bd3 Ne7 7. Bg5 Bf5 8. Bxe7 Qxe7+ 9. Ne2 Bxd3 10. Qxd3 O-O 11. O-O Nd7 12. Rfe1 Qd8 13. Nc3 Qc7 ... (351 characters truncated) ... 4 43. g5 Rh2 44. gxf6 gxf6 45. Kf4 b3 46. Kg3 Rd2 47. h5 Rxd3+ 48. Kf4 Rxd4+ 49. Ke3 c5 50. h6 b2 51. Kf3 Rb3+ 52. Ke2 b1=Q 53. Kf2 Rb2+ 54. Ke3 Qd3#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)})]
(Background on this error at: https://sqlalche.me/e/14/f405); 30277)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "game_date" of relation "fact_games" does not exist
LINE 1: INSERT INTO chess_dw.fact_games (game_url, game_date, start_...
                                                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py", line 117, in _start_by_fork
    ret = args.func(args, dag=self.dag)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/cli_config.py", line 49, in command
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/cli.py", line 115, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 483, in task_run
    task_return_code = _run_task_by_selected_method(args, _dag, ti)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 256, in _run_task_by_selected_method
    return _run_raw_task(args, ti)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/cli/commands/task_command.py", line 341, in _run_raw_task
    return ti._run_raw_task(
           ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3004, in _run_raw_task
    return _run_raw_task(
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 273, in _run_raw_task
    TaskInstance._execute_task_with_callbacks(
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3158, in _execute_task_with_callbacks
    result = self._execute_task(context, task_orig)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3182, in _execute_task
    return _execute_task(self, context, task_orig)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 238, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/python.py", line 256, in execute_callable
    return runner.run(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/scripts/python_scripts.py", line 711, in load_fact_to_postgres
    fact.to_sql(name='fact_games',
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py", line 3008, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1507, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
                                     ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "game_date" of relation "fact_games" does not exist
LINE 1: INSERT INTO chess_dw.fact_games (game_url, game_date, start_...
                                                   ^

[SQL: INSERT INTO chess_dw.fact_games (game_url, game_date, start_time, end_time, game_duration_secs, time_control, my_color, my_rating, opponent_rating, my_result, opponent_result, game_fen, opening_url, game_pgn, last_updated) VALUES (%(game_url)s, %(game_date)s, %(start_time)s, %(end_time)s, %(game_duration_secs)s, %(time_control)s, %(my_color)s, %(my_rating)s, %(opponent_rating)s, %(my_result)s, %(opponent_result)s, %(game_fen)s, %(opening_url)s, %(game_pgn)s, %(last_updated)s)]
[parameters: ({'game_url': 'https://www.chess.com/game/live/123002819534', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 2, 4, 27), 'end_time': datetime.datetime(2025, 2, 18, 2, 7, 46), 'game_duration_secs': 199, 'time_control': '2|1', 'my_color': 'white', 'my_rating': 959, 'opponent_rating': 989, 'my_result': 'win', 'opponent_result': 'abandoned', 'game_fen': 'r2q1rn1/2p5/pp1p2kp/4PR1n/3b4/P1NB3Q/1PPB2PP/R6K b - -', 'opening_url': 'https://www.chess.com/openings/Pirc-Defense-Small-Center-Defense', 'game_pgn': '1. e4 d6 2. d4 e6 3. Nc3 Ne7 4. f4 Nd7 5. Bd3 g6 6. Nf3 h6 7. O-O Bg7 8. Bd2 a6 9. a3 b6 10. Qe1 Bb7 11. Qg3 O-O 12. Qh3 Kh7 13. Ng5+ Kg8 14. Nxe6 fxe6 15. Qxe6+ Kh7 16. Qg4 Nf6 17. Qg3 Nh5 18. Qh3 Bxd4+ 19. Kh1 Bc8 20. f5 Ng8 21. fxg6+ Kxg6 22. e5+ Bf5 23. Rxf5 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123010626626', 'game_date': datetime.datetime(2025, 2, 18, 0, 0), 'start_time': datetime.datetime(2025, 2, 18, 8, 49, 20), 'end_time': datetime.datetime(2025, 2, 18, 8, 53, 38), 'game_duration_secs': 258, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 951, 'opponent_rating': 930, 'my_result': 'win', 'opponent_result': 'timeout', 'game_fen': 'r4r1k/pppq2bp/2bp2p1/5pB1/1PNPn3/2P2N1P/P4PP1/R2QR1K1 w - -', 'opening_url': 'https://www.chess.com/openings/Modern-Defense-with-1-e4', 'game_pgn': '1. e4 g6 2. e5 Bg7 3. d4 d6 4. exd6 exd6 5. c3 Ne7 6. Nf3 Nf5 7. Bd3 O-O 8. Bg5 f6 9. Bd2 Nc6 10. O-O Bd7 11. Re1 Nh6 12. Nh4 f5 13. Nf3 Ng4 14. Bf4 Ne7 15. Bc4+ Kh8 16. h3 Nh6 17. Ng5 Neg8 18. Nf3 Nf7 19. Nbd2 Bc6 20. Be6 Nfh6 21. Bxg8 Nxg8 22. Bg5 Nf6 23. b4 Qd7 24. Nc4 Ne4', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049303274', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 1, 59), 'end_time': datetime.datetime(2025, 2, 19, 10, 5, 27), 'game_duration_secs': 208, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1302, 'opponent_rating': 1306, 'my_result': 'win', 'opponent_result': 'resigned', 'game_fen': '2r3k1/p3r2p/5Bp1/1pp5/3p4/P4P2/1PPR2PP/3R2K1 w - -', 'opening_url': 'https://www.chess.com/openings/Kings-Pawn-Opening-Kings-Head-Opening', 'game_pgn': '1. e4 e5 2. f3 Nc6 3. d4 exd4 4. Bc4 Qe7 5. Ne2 d6 6. Nxd4 Nxd4 7. Qxd4 Be6 8. Nd2 Bxc4 9. Nxc4 Nf6 10. Bf4 Qd7 11. O-O Be7 12. Rad1 Nh5 13. Be3 O-O  ... (23 characters truncated) ... 8 16. a3 c5 17. Qd5 Nf6 18. Qxe6 fxe6 19. Rd2 Rd7 20. Rfd1 Rad8 21. Nc4 b5 22. Na5 d5 23. Nc6 Rc8 24. exd5 exd5 25. Nxe7+ Rxe7 26. Bh4 d4 27. Bxf6 g6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123049832654', 'game_date': datetime.datetime(2025, 2, 19, 0, 0), 'start_time': datetime.datetime(2025, 2, 19, 10, 23, 9), 'end_time': datetime.datetime(2025, 2, 19, 10, 34, 29), 'game_duration_secs': 680, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1303, 'opponent_rating': 1305, 'my_result': 'insufficient', 'opponent_result': 'insufficient', 'game_fen': '8/8/8/8/8/6kN/3K4/8 b - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Queens-Knight-Variation-2...d5', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. Qf3 c6 5. d4 Bd6 6. Bd3 Ne7 7. Bd2 O-O 8. O-O-O Nd7 9. h4 Nf6 10. Re1 Bg4 11. Qe3 Re8 12. f3 Bg3 13. fxg4 Bxe1 14. ... (625 characters truncated) ... e2+ 65. Ka3 Kg3 66. Nxa4 Re5 67. Kb3 Kg4 68. Nc3 Rxg5 69. hxg5 Kxg5 70. Ne2 Kg4 71. Kc3 h4 72. Kd2 Kf3 73. Ng1+ Kg2 74. Ne2 h3 75. Nf4+ Kg3 76. Nxh3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123092292140', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 13, 50, 4), 'end_time': datetime.datetime(2025, 2, 20, 13, 57, 38), 'game_duration_secs': 454, 'time_control': '3|2', 'my_color': 'black', 'my_rating': 1282, 'opponent_rating': 1303, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '8/5k1p/8/5p2/1P3P2/P7/3q1QKP/8 b - -', 'opening_url': 'https://www.chess.com/openings/Queens-Gambit-Accepted-Old-Variation...4.Bxc4-exd4-5.exd4-Bd6-6.Nf3', 'game_pgn': '1. e4 e6 2. Nf3 d5 3. exd5 exd5 4. d4 Bd6 5. c4 dxc4 6. Bxc4 Ne7 7. Ng5 O-O 8. Qf3 Be6 9. Bxe6 fxe6 10. Qxb7 Nbc6 11. Nxe6 Bb4+ 12. Bd2 Bxd2+ 13. Nxd ... (132 characters truncated) ...  Qc7 Nd4 25. Qxa7 Ndf5 26. Rc7 Re8 27. Re1 g6 28. g4 Kf7 29. gxf5 gxf5 30. Rexe7+ Rxe7 31. Rxe7+ Qxe7 32. Qc5 Qe4+ 33. Kg1 Qe1+ 34. Kg2 Qd2+ 35. Qf2 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123098362392', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 16, 50, 20), 'end_time': datetime.datetime(2025, 2, 20, 16, 56, 58), 'game_duration_secs': 398, 'time_control': '3|2', 'my_color': 'white', 'my_rating': 1269, 'opponent_rating': 1423, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': 'r4rk1/pp1N1pp1/2p1b3/8/3P2Q1/8/1q4PP/R4R1K w - -', 'opening_url': 'https://www.chess.com/openings/Sicilian-Defense-McDonnell-Attack-2...Nc6-3.Nf3-e6-4.Bb5', 'game_pgn': '1. e4 c5 2. f4 e6 3. Nf3 Nc6 4. Bb5 Qb6 5. Bxc6 dxc6 6. O-O Nf6 7. d3 Be7 8. Nc3 c4+ 9. Kh1 cxd3 10. cxd3 O-O 11. Qe2 Bc5 12. Na4 Qa5 13. Nxc5 Qxc5 1 ... (9 characters truncated) ... 5 15. Ne5 Nxe4 16. Qg4 Nf6 17. Qg5 h6 18. Qg3 Qxb2 19. f5 exf5 20. Bxh6 Nh5 21. Qe3 f4 22. Bxf4 Nxf4 23. Qxf4 Be6 24. d4 Bd5 25. Qg4 Bxa2 26. Nd7 Be6', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123101248120', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 18, 14, 35), 'end_time': datetime.datetime(2025, 2, 20, 18, 18, 18), 'game_duration_secs': 223, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 944, 'opponent_rating': 949, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': 'r3r2k/4PQpp/1pR2p2/2np4/8/8/5PPP/3q2K1 w - -', 'opening_url': 'https://www.chess.com/openings/French-Defense-Kings-Indian-Attack-2...d5', 'game_pgn': '1. e4 e6 2. d3 d5 3. exd5 exd5 4. Nf3 Bc5 5. Be2 Ne7 6. O-O O-O 7. Nc3 c6 8. Bf4 Bg4 9. d4 Bd6 10. Bxd6 Qxd6 11. Ne5 Bxe2 12. Qxe2 Re8 13. Qg4 Ng6 14. Rfe1 Nxe5 15. dxe5 Qc5 16. e6 f6 17. Na4 Qxc2 18. b3 b6 19. e7 Na6 20. Rac1 Qxa2 21. Rxc6 Qxb3 22. Nxb6 axb6 23. Qe6+ Kh8 24. Qf7 Nc5 25. Rd1 Qxd1#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/123104732000', 'game_date': datetime.datetime(2025, 2, 20, 0, 0), 'start_time': datetime.datetime(2025, 2, 20, 20, 2, 6), 'end_time': datetime.datetime(2025, 2, 20, 20, 6, 35), 'game_duration_secs': 269, 'time_control': '2|1', 'my_color': 'black', 'my_rating': 938, 'opponent_rating': 942, 'my_result': 'timeout', 'opponent_result': 'win', 'game_fen': '5rk1/5ppp/1p2pn2/p1p5/3p4/PP1P1BQ1/R1P1qP2/2B2RK1 b - -', 'opening_url': 'https://www.chess.com/openings/Nimzowitsch-Larsen-Attack-Classical-Variation-2.Bb2-e6', 'game_pgn': '1. b3 e6 2. Bb2 d5 3. g3 Nf6 4. Bg2 Bd6 5. d3 O-O 6. Nd2 b6 7. e3 Bb7 8. Ne2 Nbd7 9. a3 c5 10. h3 d4 11. e4 Bc7 12. Nf3 Nh5 13. g4 Nf4 14. Nxf4 Bxf4  ... (9 characters truncated) ... xh4 16. Qe2 Nf6 17. O-O Nd7 18. Qf3 Bc7 19. Qg3 Qg5 20. Qxc7 Bxe4 21. Bxe4 Nf6 22. Bc1 Qh4 23. Bxa8 Qxh3 24. Bg2 Qxg4 25. Qg3 Qe2 26. Ra2 a5 27. Bf3 ', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}  ... displaying 10 of 491 total bound parameter sets ...  {'game_url': 'https://www.chess.com/game/live/132363662425', 'game_date': datetime.datetime(2025, 2, 3, 0, 0), 'start_time': datetime.datetime(2025, 2, 3, 23, 21, 40), 'end_time': datetime.datetime(2025, 2, 3, 23, 35, 46), 'game_duration_secs': 846, 'time_control': '10', 'my_color': 'white', 'my_rating': 1491, 'opponent_rating': 1488, 'my_result': 'checkmated', 'opponent_result': 'win', 'game_fen': '8/1ppkr1p1/p2p3p/3P1KrP/2P2R2/8/1P3R2/8 w - - 0 37', 'opening_url': 'https://www.chess.com/openings/Italian-Game-3...d6-4.d4-exd4', 'game_pgn': '1. e4 e5 2. Nf3 Nc6 3. d4 exd4 4. Bc4 d6 5. O-O Bg4 6. Qd3 Bxf3 7. Qxf3 Qf6 8. Qb3 O-O-O 9. Bxf7 Nge7 10. Bd5 Nxd5 11. exd5 Ne7 12. a4 Qf7 13. c4 Nf5 ... (136 characters truncated) ... 4+ 25. Rxd4 Re8 26. Rdf4 Kd7 27. Kh2 Rb3 28. R1f2 Re7 29. h4 Rb4 30. h5 h6 31. g4 Ra4 32. Kh3 Rxa5 33. Kh4 Ra1 34. g5 Rh1+ 35. Kg4 Rg1+ 36. Kf5 Rxg5#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)}, {'game_url': 'https://www.chess.com/game/live/132408669035', 'game_date': datetime.datetime(2025, 2, 4, 0, 0), 'start_time': datetime.datetime(2025, 2, 4, 11, 50, 36), 'end_time': datetime.datetime(2025, 2, 4, 11, 59, 8), 'game_duration_secs': 512, 'time_control': '10', 'my_color': 'black', 'my_rating': 1501, 'opponent_rating': 1478, 'my_result': 'win', 'opponent_result': 'checkmated', 'game_fen': '6k1/7p/5p1P/2pp1P2/3r4/3qK3/1r6/8 w - - 4 55', 'opening_url': 'https://www.chess.com/openings/French-Defense-Exchange-Variation-3...exd5-4.Nc3', 'game_pgn': '1. e4 e6 2. Nc3 d5 3. exd5 exd5 4. d4 c6 5. Nf3 Bd6 6. Bd3 Ne7 7. Bg5 Bf5 8. Bxe7 Qxe7+ 9. Ne2 Bxd3 10. Qxd3 O-O 11. O-O Nd7 12. Rfe1 Qd8 13. Nc3 Qc7 ... (351 characters truncated) ... 4 43. g5 Rh2 44. gxf6 gxf6 45. Kf4 b3 46. Kg3 Rd2 47. h5 Rxd3+ 48. Kf4 Rxd4+ 49. Ke3 c5 50. h6 b2 51. Kf3 Rb3+ 52. Ke2 b1=Q 53. Kf2 Rb2+ 54. Ke3 Qd3#', 'last_updated': datetime.datetime(2025, 2, 1, 0, 0)})]
(Background on this error at: https://sqlalche.me/e/14/f405)
[2025-03-26T02:37:06.759+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 1
[2025-03-26T02:37:06.776+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
